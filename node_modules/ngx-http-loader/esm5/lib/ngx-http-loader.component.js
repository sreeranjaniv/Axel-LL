/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, TemplateRef } from '@angular/core';
import { merge, timer } from 'rxjs';
import { switchMap, debounce, distinctUntilChanged, tap, partition } from 'rxjs/operators';
import { NgxHttpLoaderInterceptor } from './ngx-loader-interceptor.service';
import { NgxLoader } from './ngx-http-loader';
import { NgxHttpLoaderService } from './ngx-http-loader.service';
import { DomSanitizer } from '@angular/platform-browser';
var NgxHttpLoaderComponent = /** @class */ (function () {
    function NgxHttpLoaderComponent(requestService, service, sanitizer) {
        this.requestService = requestService;
        this.service = service;
        this.sanitizer = sanitizer;
        this.customEnumLoader = NgxLoader;
        this.loader = NgxLoader.RIPPLE;
        this.filterUrlRegexPatterns = [];
        this.filterUrls = [];
        this.filterHttpHeaders = [];
        this.filterHttpMethods = [];
        this.delay = 0;
        this.extraDelay = 0;
        this.minDuration = 0;
        this.opacity = 0.8;
        // @Input() public backdropBackgroundColor = 'linear-gradient(45deg, #222428, #444856)';
        // @Input() public backdropBackgroundColor = 'transperent';
        this.backdropBackgroundColor = 'linear-gradient(0deg, black, transparent);';
        this.iconColor = 'white';
        this.title = '';
        this.titleColor = '#fff';
        this.titleSize = '3rem';
        this.subTitle = '';
        this.subTitleColor = '#6c757d';
        this.subTitleSize = '1.2rem';
        this.custom = false;
        this.showuntil = Date.now();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    NgxHttpLoaderComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (this.filterUrlRegexPatterns.length > 0 || this.filterUrls.length > 0
            || this.filterHttpHeaders.length > 0 || this.filterHttpMethods.length > 0)
            this.initAllFilters();
    };
    /**
     * @return {?}
     */
    NgxHttpLoaderComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.initAllFilters();
    };
    /**
     * @return {?}
     */
    NgxHttpLoaderComponent.prototype.initAllFilters = /**
     * @return {?}
     */
    function () {
        this.requestService.setUrlPatterns = this.filterUrlRegexPatterns;
        this.requestService.setFilterUrls = this.filterUrls;
        this.requestService.setFilterMethods = this.filterHttpMethods;
        this.requestService.setFilterHeaders = this.filterHttpHeaders;
        this.initShowObservable();
    };
    /**
     * @return {?}
     */
    NgxHttpLoaderComponent.prototype.initShowObservable = /**
     * @return {?}
     */
    function () {
        var _this = this;
        var _a = tslib_1.__read(partition(function ($hide) { return $hide; })(this.requestService.reqStatus), 2), show = _a[0], hide = _a[1];
        this.show$ = merge(this.requestService.reqStatus.pipe(switchMap(function () { return show.pipe(debounce(function () { return timer(_this.delay); })); })), show.pipe(switchMap(function () { return hide.pipe(debounce(function () { return _this.showUpto(); })); })), this.service.isShowLoader).pipe(distinctUntilChanged(), tap(function (x) { return _this.updateHideDelay(x); }));
    };
    /**
     * @param {?} bool
     * @return {?}
     */
    NgxHttpLoaderComponent.prototype.updateHideDelay = /**
     * @param {?} bool
     * @return {?}
     */
    function (bool) {
        if (bool)
            this.showuntil = Date.now() + this.minDuration;
    };
    /**
     * @return {?}
     */
    NgxHttpLoaderComponent.prototype.showUpto = /**
     * @return {?}
     */
    function () {
        return timer(Math.max(this.extraDelay, this.showuntil - Date.now()));
    };
    NgxHttpLoaderComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-http-loader',
                    template: "<div *ngIf=\"show$ | async\">\r\n    <ng-template [ngTemplateOutlet]=\"customTemplate || defaultTemplate\"></ng-template>\r\n    <ng-template #defaultTemplate>\r\n        <div class=\"custom-loader vertical-center\"\r\n            [attr.style]=\"sanitizer.bypassSecurityTrustStyle('--background-color: ' + backdropBackgroundColor + '; opacity :' + opacity)\">\r\n            <div class=\"w-100 text-center text-light\"\r\n                [attr.style]=\"sanitizer.bypassSecurityTrustStyle('--iconcolor: ' + iconColor)\">\r\n                <ng-container *ngIf=\"custom\">\r\n                    <ng-template [ngTemplateOutlet]=\"customLoader\"></ng-template>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"!custom\">\r\n                    <lib-gear-loader *ngIf=\"loader === customEnumLoader.GEAR\"></lib-gear-loader>\r\n                    <lib-grid-loader *ngIf=\"loader === customEnumLoader.GRID\"></lib-grid-loader>\r\n                    <lib-dual-ring-loader *ngIf=\"loader === customEnumLoader.DUALRING\"></lib-dual-ring-loader>\r\n                    <lib-clock-loader *ngIf=\"loader === customEnumLoader.CLOCK\"></lib-clock-loader>\r\n                    <lib-default-loader *ngIf=\"loader === customEnumLoader.DEFAULT\"></lib-default-loader>\r\n                    <lib-ellipsis-loader *ngIf=\"loader === customEnumLoader.ELLIPSIS\"></lib-ellipsis-loader>\r\n                    <lib-spinner-loader *ngIf=\"loader === customEnumLoader.SPINNER\"></lib-spinner-loader>\r\n                    <lib-facebook-loader *ngIf=\"loader === customEnumLoader.FACEBOOK\"></lib-facebook-loader>\r\n                    <lib-heart-loader *ngIf=\"loader === customEnumLoader.HEART\"></lib-heart-loader>\r\n                    <lib-hourglass-loader *ngIf=\"loader === customEnumLoader.HOURGLASS\"></lib-hourglass-loader>\r\n                    <lib-ring-loader *ngIf=\"loader === customEnumLoader.RING\"></lib-ring-loader>\r\n                    <lib-ripple-loader *ngIf=\"loader === customEnumLoader.RIPPLE\"></lib-ripple-loader>\r\n                    <lib-roller-loader *ngIf=\"loader === customEnumLoader.ROLLER\"></lib-roller-loader>\r\n                    <lib-water-wave-loader *ngIf=\"loader === customEnumLoader.WATERWAVE\"></lib-water-wave-loader>\r\n                    <lib-multicircle-loader *ngIf=\"loader === customEnumLoader.MULTICIRCLE\"></lib-multicircle-loader>\r\n                    <lib-three-bounce-loader *ngIf=\"loader === customEnumLoader.THREEBOUNCE\"></lib-three-bounce-loader>\r\n                    <lib-jellybox-loader *ngIf=\"loader === customEnumLoader.JELLYBOX\"></lib-jellybox-loader>\r\n                    <lib-rotating-plane *ngIf=\"loader === customEnumLoader.ROTATINGPLANE\"></lib-rotating-plane>\r\n                </ng-container>\r\n                <h1 *ngIf=\"title\" class=\"font-weight-bold text-shadow\"\r\n                    style=\"font-family:Trebuchet MS,Helvetica,sans-serif; width: 50%; margin: 10px auto; margin-top: 20px; word-break: break-all;\" \r\n                    [style.color]=\"titleColor\" [style.fontSize]=\"titleSize\">\r\n                    {{title}}\r\n                </h1>\r\n                <div style=\"width: 50%; margin: 10px auto; word-break: break-all;\" *ngIf=\"subTitle\" [style.color]=\"subTitleColor\" [style.fontSize]=\"subTitleSize\">{{subTitle}}</div>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n</div>",
                    styles: [".custom-loader{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--background-color);color:#fff;z-index:99999;transition:.3s linear}.custom-loader ::ng-deep>*{vertical-align:middle;white-space:normal;display:inline-block;z-index:99999999999}.vertical-center:before{content:\"\";display:inline-block;vertical-align:middle;width:0;height:100%}"]
                }] }
    ];
    /** @nocollapse */
    NgxHttpLoaderComponent.ctorParameters = function () { return [
        { type: NgxHttpLoaderInterceptor },
        { type: NgxHttpLoaderService },
        { type: DomSanitizer }
    ]; };
    NgxHttpLoaderComponent.propDecorators = {
        customTemplate: [{ type: Input }],
        customLoader: [{ type: Input }],
        loader: [{ type: Input }],
        filterUrlRegexPatterns: [{ type: Input }],
        filterUrls: [{ type: Input }],
        filterHttpHeaders: [{ type: Input }],
        filterHttpMethods: [{ type: Input }],
        delay: [{ type: Input }],
        extraDelay: [{ type: Input }],
        minDuration: [{ type: Input }],
        opacity: [{ type: Input }],
        backdropBackgroundColor: [{ type: Input }],
        iconColor: [{ type: Input }],
        title: [{ type: Input }],
        titleColor: [{ type: Input }],
        titleSize: [{ type: Input }],
        subTitle: [{ type: Input }],
        subTitleColor: [{ type: Input }],
        subTitleSize: [{ type: Input }],
        custom: [{ type: Input }]
    };
    return NgxHttpLoaderComponent;
}());
export { NgxHttpLoaderComponent };
if (false) {
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.customEnumLoader;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.customTemplate;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.customLoader;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.loader;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.filterUrlRegexPatterns;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.filterUrls;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.filterHttpHeaders;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.filterHttpMethods;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.delay;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.extraDelay;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.minDuration;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.opacity;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.backdropBackgroundColor;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.iconColor;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.title;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.titleColor;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.titleSize;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.subTitle;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.subTitleColor;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.subTitleSize;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.custom;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.show$;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.showuntil;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.requestService;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.service;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.sanitizer;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWh0dHAtbG9hZGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1odHRwLWxvYWRlci8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtaHR0cC1sb2FkZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQXFCLFdBQVcsRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDaEcsT0FBTyxFQUFFLEtBQUssRUFBYyxLQUFLLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDaEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzNGLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQzVFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUM5QyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNqRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7O0lBb0N2RCxnQ0FDVSxnQkFDRCxTQUNBO1FBRkMsbUJBQWMsR0FBZCxjQUFjO1FBQ2YsWUFBTyxHQUFQLE9BQU87UUFDUCxjQUFTLEdBQVQsU0FBUztnQ0E5QlEsU0FBUztzQkFHSyxTQUFTLENBQUMsTUFBTTtzQ0FDTCxFQUFFOzBCQUNkLEVBQUU7aUNBQ0ssRUFBRTtpQ0FDRixFQUFFO3FCQUN4QixDQUFDOzBCQUNJLENBQUM7MkJBQ0EsQ0FBQzt1QkFDRyxHQUFHOzs7dUNBR0ssNENBQTRDO3lCQUNsRCxPQUFPO3FCQUNYLEVBQUU7MEJBQ0csTUFBTTt5QkFDUCxNQUFNO3dCQUNQLEVBQUU7NkJBQ0csU0FBUzs0QkFDVixRQUFRO3NCQUNiLEtBQUs7eUJBR25CLElBQUksQ0FBQyxHQUFHLEVBQUU7S0FPN0I7Ozs7O0lBRUQsNENBQVc7Ozs7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LCBJbnB1dCwgT25Jbml0LCBPbkNoYW5nZXMsIFRlbXBsYXRlUmVmLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBtZXJnZSwgT2JzZXJ2YWJsZSwgdGltZXIgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHN3aXRjaE1hcCwgZGVib3VuY2UsIGRpc3RpbmN0VW50aWxDaGFuZ2VkLCB0YXAsIHBhcnRpdGlvbiB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IE5neEh0dHBMb2FkZXJJbnRlcmNlcHRvciB9IGZyb20gJy4vbmd4LWxvYWRlci1pbnRlcmNlcHRvci5zZXJ2aWNlJztcbmltcG9ydCB7IE5neExvYWRlciB9IGZyb20gJy4vbmd4LWh0dHAtbG9hZGVyJztcbmltcG9ydCB7IE5neEh0dHBMb2FkZXJTZXJ2aWNlIH0gZnJvbSAnLi9uZ3gtaHR0cC1sb2FkZXIuc2VydmljZSc7XG5pbXBvcnQgeyBEb21TYW5pdGl6ZXIgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LWh0dHAtbG9hZGVyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25neC1odHRwLWxvYWRlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL25neC1odHRwLWxvYWRlci5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIE5neEh0dHBMb2FkZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XG5cbiAgcHVibGljIGN1c3RvbUVudW1Mb2FkZXIgPSBOZ3hMb2FkZXI7XG4gIEBJbnB1dCgpIHB1YmxpYyBjdXN0b21UZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcbiAgQElucHV0KCkgcHVibGljIGN1c3RvbUxvYWRlcjogVGVtcGxhdGVSZWY8YW55PjtcbiAgQElucHV0KCkgcHVibGljIGxvYWRlcjogc3RyaW5nIHwgbnVsbCA9IE5neExvYWRlci5SSVBQTEU7XG4gIEBJbnB1dCgpIHB1YmxpYyBmaWx0ZXJVcmxSZWdleFBhdHRlcm5zOiBSZWdFeHBbXSA9IFtdO1xuICBASW5wdXQoKSBwdWJsaWMgZmlsdGVyVXJsczogc3RyaW5nW10gPSBbXTtcbiAgQElucHV0KCkgcHVibGljIGZpbHRlckh0dHBIZWFkZXJzOiBzdHJpbmdbXSA9IFtdO1xuICBASW5wdXQoKSBwdWJsaWMgZmlsdGVySHR0cE1ldGhvZHM6IHN0cmluZ1tdID0gW107XG4gIEBJbnB1dCgpIHB1YmxpYyBkZWxheSA9IDA7XG4gIEBJbnB1dCgpIHB1YmxpYyBleHRyYURlbGF5ID0gMDtcbiAgQElucHV0KCkgcHVibGljIG1pbkR1cmF0aW9uID0gMDtcbiAgQElucHV0KCkgcHVibGljIG9wYWNpdHk6IG51bWJlciA9IDAuODtcbiAgLy8gQElucHV0KCkgcHVibGljIGJhY2tkcm9wQmFja2dyb3VuZENvbG9yID0gJ2xpbmVhci1ncmFkaWVudCg0NWRlZywgIzIyMjQyOCwgIzQ0NDg1NiknO1xuICAvLyBASW5wdXQoKSBwdWJsaWMgYmFja2Ryb3BCYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwZXJlbnQnO1xuICBASW5wdXQoKSBwdWJsaWMgYmFja2Ryb3BCYWNrZ3JvdW5kQ29sb3IgPSAnbGluZWFyLWdyYWRpZW50KDBkZWcsIGJsYWNrLCB0cmFuc3BhcmVudCk7JztcbiAgQElucHV0KCkgcHVibGljIGljb25Db2xvcjogc3RyaW5nID0gJ3doaXRlJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlOiBzdHJpbmcgPSAnJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlQ29sb3I6IHN0cmluZyA9ICcjZmZmJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlU2l6ZTogc3RyaW5nID0gJzNyZW0nO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGU6IHN0cmluZyA9ICcnO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGVDb2xvcjogc3RyaW5nID0gJyM2Yzc1N2QnO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGVTaXplOiBzdHJpbmcgPSAnMS4ycmVtJztcbiAgQElucHV0KCkgcHVibGljIGN1c3RvbTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHB1YmxpYyBzaG93JCE6IE9ic2VydmFibGU8Ym9vbGVhbj47XG4gIHByaXZhdGUgc2hvd3VudGlsID0gRGF0ZS5ub3coKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlcXVlc3RTZXJ2aWNlOiBOZ3hIdHRwTG9hZGVySW50ZXJjZXB0b3IsXG4gICAgcHVibGljIHNlcnZpY2U6IE5neEh0dHBMb2FkZXJTZXJ2aWNlLFxuICAgIHB1YmxpYyBzYW5pdGl6ZXI6IERvbVNhbml0aXplclxuICApIHtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5maWx0ZXJVcmxSZWdleFBhdHRlcm5zLmxlbmd0aCA+IDAgfHwgdGhpcy5maWx0ZXJVcmxzLmxlbmd0aCA+IDBcbiAgICAgIHx8IHRoaXMuZmlsdGVySHR0cEhlYWRlcnMubGVuZ3RoID4gMCB8fCB0aGlzLmZpbHRlckh0dHBNZXRob2RzLmxlbmd0aCA+IDApIHRoaXMuaW5pdEFsbEZpbHRlcnMoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuaW5pdEFsbEZpbHRlcnMoKTtcbiAgfVxuXG4gIGluaXRBbGxGaWx0ZXJzKCkge1xuICAgIHRoaXMucmVxdWVzdFNlcnZpY2Uuc2V0VXJsUGF0dGVybnMgPSB0aGlzLmZpbHRlclVybFJlZ2V4UGF0dGVybnM7XG4gICAgdGhpcy5yZXF1ZXN0U2VydmljZS5zZXRGaWx0ZXJVcmxzID0gdGhpcy5maWx0ZXJVcmxzO1xuICAgIHRoaXMucmVxdWVzdFNlcnZpY2Uuc2V0RmlsdGVyTWV0aG9kcyA9IHRoaXMuZmlsdGVySHR0cE1ldGhvZHM7XG4gICAgdGhpcy5yZXF1ZXN0U2VydmljZS5zZXRGaWx0ZXJIZWFkZXJzID0gdGhpcy5maWx0ZXJIdHRwSGVhZGVycztcbiAgICB0aGlzLmluaXRTaG93T2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgaW5pdFNob3dPYnNlcnZhYmxlKCkge1xuICAgIGNvbnN0IFtzaG93LCBoaWRlXSA9IHBhcnRpdGlvbigoJGhpZGU6IGJvb2xlYW4pID0+ICRoaWRlKSh0aGlzLnJlcXVlc3RTZXJ2aWNlLnJlcVN0YXR1cyk7XG4gICAgdGhpcy5zaG93JCA9IG1lcmdlKFxuICAgICAgdGhpcy5yZXF1ZXN0U2VydmljZS5yZXFTdGF0dXMucGlwZShzd2l0Y2hNYXAoKCkgPT4gc2hvdy5waXBlKGRlYm91bmNlKCgpID0+IHRpbWVyKHRoaXMuZGVsYXkpKSkpKSxcbiAgICAgIHNob3cucGlwZShzd2l0Y2hNYXAoKCkgPT4gaGlkZS5waXBlKGRlYm91bmNlKCgpID0+IHRoaXMuc2hvd1VwdG8oKSkpKSksXG4gICAgICB0aGlzLnNlcnZpY2UuaXNTaG93TG9hZGVyXG4gICAgKS5waXBlKGRpc3RpbmN0VW50aWxDaGFuZ2VkKCksIHRhcCh4ID0+IHRoaXMudXBkYXRlSGlkZURlbGF5KHgpKSlcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlSGlkZURlbGF5KGJvb2w6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBpZiAoYm9vbCkgdGhpcy5zaG93dW50aWwgPSBEYXRlLm5vdygpICsgdGhpcy5taW5EdXJhdGlvbjtcbiAgfVxuXG4gIHByaXZhdGUgc2hvd1VwdG8oKTogT2JzZXJ2YWJsZTxudW1iZXI+IHtcbiAgICByZXR1cm4gdGltZXIoTWF0aC5tYXgodGhpcy5leHRyYURlbGF5LCB0aGlzLnNob3d1bnRpbCAtIERhdGUubm93KCkpKTtcbiAgfVxufVxuIl19