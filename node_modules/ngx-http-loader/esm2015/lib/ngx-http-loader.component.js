/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, Input, TemplateRef } from '@angular/core';
import { merge, timer } from 'rxjs';
import { switchMap, debounce, distinctUntilChanged, tap, partition } from 'rxjs/operators';
import { NgxHttpLoaderInterceptor } from './ngx-loader-interceptor.service';
import { NgxLoader } from './ngx-http-loader';
import { NgxHttpLoaderService } from './ngx-http-loader.service';
import { DomSanitizer } from '@angular/platform-browser';
export class NgxHttpLoaderComponent {
    /**
     * @param {?} requestService
     * @param {?} service
     * @param {?} sanitizer
     */
    constructor(requestService, service, sanitizer) {
        this.requestService = requestService;
        this.service = service;
        this.sanitizer = sanitizer;
        this.customEnumLoader = NgxLoader;
        this.loader = NgxLoader.RIPPLE;
        this.filterUrlRegexPatterns = [];
        this.filterUrls = [];
        this.filterHttpHeaders = [];
        this.filterHttpMethods = [];
        this.delay = 0;
        this.extraDelay = 0;
        this.minDuration = 0;
        this.opacity = 0.8;
        // @Input() public backdropBackgroundColor = 'linear-gradient(45deg, #222428, #444856)';
        // @Input() public backdropBackgroundColor = 'transperent';
        this.backdropBackgroundColor = 'linear-gradient(0deg, black, transparent);';
        this.iconColor = 'white';
        this.title = '';
        this.titleColor = '#fff';
        this.titleSize = '3rem';
        this.subTitle = '';
        this.subTitleColor = '#6c757d';
        this.subTitleSize = '1.2rem';
        this.custom = false;
        this.showuntil = Date.now();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (this.filterUrlRegexPatterns.length > 0 || this.filterUrls.length > 0
            || this.filterHttpHeaders.length > 0 || this.filterHttpMethods.length > 0)
            this.initAllFilters();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.initAllFilters();
    }
    /**
     * @return {?}
     */
    initAllFilters() {
        this.requestService.setUrlPatterns = this.filterUrlRegexPatterns;
        this.requestService.setFilterUrls = this.filterUrls;
        this.requestService.setFilterMethods = this.filterHttpMethods;
        this.requestService.setFilterHeaders = this.filterHttpHeaders;
        this.initShowObservable();
    }
    /**
     * @return {?}
     */
    initShowObservable() {
        const [show, hide] = partition(($hide) => $hide)(this.requestService.reqStatus);
        this.show$ = merge(this.requestService.reqStatus.pipe(switchMap(() => show.pipe(debounce(() => timer(this.delay))))), show.pipe(switchMap(() => hide.pipe(debounce(() => this.showUpto())))), this.service.isShowLoader).pipe(distinctUntilChanged(), tap(x => this.updateHideDelay(x)));
    }
    /**
     * @param {?} bool
     * @return {?}
     */
    updateHideDelay(bool) {
        if (bool)
            this.showuntil = Date.now() + this.minDuration;
    }
    /**
     * @return {?}
     */
    showUpto() {
        return timer(Math.max(this.extraDelay, this.showuntil - Date.now()));
    }
}
NgxHttpLoaderComponent.decorators = [
    { type: Component, args: [{
                selector: 'ngx-http-loader',
                template: "<div *ngIf=\"show$ | async\">\r\n    <ng-template [ngTemplateOutlet]=\"customTemplate || defaultTemplate\"></ng-template>\r\n    <ng-template #defaultTemplate>\r\n        <div class=\"custom-loader vertical-center\"\r\n            [attr.style]=\"sanitizer.bypassSecurityTrustStyle('--background-color: ' + backdropBackgroundColor + '; opacity :' + opacity)\">\r\n            <div class=\"w-100 text-center text-light\"\r\n                [attr.style]=\"sanitizer.bypassSecurityTrustStyle('--iconcolor: ' + iconColor)\">\r\n                <ng-container *ngIf=\"custom\">\r\n                    <ng-template [ngTemplateOutlet]=\"customLoader\"></ng-template>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"!custom\">\r\n                    <lib-gear-loader *ngIf=\"loader === customEnumLoader.GEAR\"></lib-gear-loader>\r\n                    <lib-grid-loader *ngIf=\"loader === customEnumLoader.GRID\"></lib-grid-loader>\r\n                    <lib-dual-ring-loader *ngIf=\"loader === customEnumLoader.DUALRING\"></lib-dual-ring-loader>\r\n                    <lib-clock-loader *ngIf=\"loader === customEnumLoader.CLOCK\"></lib-clock-loader>\r\n                    <lib-default-loader *ngIf=\"loader === customEnumLoader.DEFAULT\"></lib-default-loader>\r\n                    <lib-ellipsis-loader *ngIf=\"loader === customEnumLoader.ELLIPSIS\"></lib-ellipsis-loader>\r\n                    <lib-spinner-loader *ngIf=\"loader === customEnumLoader.SPINNER\"></lib-spinner-loader>\r\n                    <lib-facebook-loader *ngIf=\"loader === customEnumLoader.FACEBOOK\"></lib-facebook-loader>\r\n                    <lib-heart-loader *ngIf=\"loader === customEnumLoader.HEART\"></lib-heart-loader>\r\n                    <lib-hourglass-loader *ngIf=\"loader === customEnumLoader.HOURGLASS\"></lib-hourglass-loader>\r\n                    <lib-ring-loader *ngIf=\"loader === customEnumLoader.RING\"></lib-ring-loader>\r\n                    <lib-ripple-loader *ngIf=\"loader === customEnumLoader.RIPPLE\"></lib-ripple-loader>\r\n                    <lib-roller-loader *ngIf=\"loader === customEnumLoader.ROLLER\"></lib-roller-loader>\r\n                    <lib-water-wave-loader *ngIf=\"loader === customEnumLoader.WATERWAVE\"></lib-water-wave-loader>\r\n                    <lib-multicircle-loader *ngIf=\"loader === customEnumLoader.MULTICIRCLE\"></lib-multicircle-loader>\r\n                    <lib-three-bounce-loader *ngIf=\"loader === customEnumLoader.THREEBOUNCE\"></lib-three-bounce-loader>\r\n                    <lib-jellybox-loader *ngIf=\"loader === customEnumLoader.JELLYBOX\"></lib-jellybox-loader>\r\n                    <lib-rotating-plane *ngIf=\"loader === customEnumLoader.ROTATINGPLANE\"></lib-rotating-plane>\r\n                </ng-container>\r\n                <h1 *ngIf=\"title\" class=\"font-weight-bold text-shadow\"\r\n                    style=\"font-family:Trebuchet MS,Helvetica,sans-serif; width: 50%; margin: 10px auto; margin-top: 20px; word-break: break-all;\" \r\n                    [style.color]=\"titleColor\" [style.fontSize]=\"titleSize\">\r\n                    {{title}}\r\n                </h1>\r\n                <div style=\"width: 50%; margin: 10px auto; word-break: break-all;\" *ngIf=\"subTitle\" [style.color]=\"subTitleColor\" [style.fontSize]=\"subTitleSize\">{{subTitle}}</div>\r\n            </div>\r\n        </div>\r\n    </ng-template>\r\n</div>",
                styles: [".custom-loader{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--background-color);color:#fff;z-index:99999;transition:.3s linear}.custom-loader ::ng-deep>*{vertical-align:middle;white-space:normal;display:inline-block;z-index:99999999999}.vertical-center:before{content:\"\";display:inline-block;vertical-align:middle;width:0;height:100%}"]
            }] }
];
/** @nocollapse */
NgxHttpLoaderComponent.ctorParameters = () => [
    { type: NgxHttpLoaderInterceptor },
    { type: NgxHttpLoaderService },
    { type: DomSanitizer }
];
NgxHttpLoaderComponent.propDecorators = {
    customTemplate: [{ type: Input }],
    customLoader: [{ type: Input }],
    loader: [{ type: Input }],
    filterUrlRegexPatterns: [{ type: Input }],
    filterUrls: [{ type: Input }],
    filterHttpHeaders: [{ type: Input }],
    filterHttpMethods: [{ type: Input }],
    delay: [{ type: Input }],
    extraDelay: [{ type: Input }],
    minDuration: [{ type: Input }],
    opacity: [{ type: Input }],
    backdropBackgroundColor: [{ type: Input }],
    iconColor: [{ type: Input }],
    title: [{ type: Input }],
    titleColor: [{ type: Input }],
    titleSize: [{ type: Input }],
    subTitle: [{ type: Input }],
    subTitleColor: [{ type: Input }],
    subTitleSize: [{ type: Input }],
    custom: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.customEnumLoader;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.customTemplate;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.customLoader;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.loader;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.filterUrlRegexPatterns;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.filterUrls;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.filterHttpHeaders;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.filterHttpMethods;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.delay;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.extraDelay;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.minDuration;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.opacity;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.backdropBackgroundColor;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.iconColor;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.title;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.titleColor;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.titleSize;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.subTitle;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.subTitleColor;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.subTitleSize;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.custom;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.show$;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.showuntil;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.requestService;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.service;
    /** @type {?} */
    NgxHttpLoaderComponent.prototype.sanitizer;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWh0dHAtbG9hZGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1odHRwLWxvYWRlci8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtaHR0cC1sb2FkZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBcUIsV0FBVyxFQUFpQixNQUFNLGVBQWUsQ0FBQztBQUNoRyxPQUFPLEVBQUUsS0FBSyxFQUFjLEtBQUssRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNoRCxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxvQkFBb0IsRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0YsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDNUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQzlDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQU96RCxNQUFNOzs7Ozs7SUE2QkosWUFDVSxnQkFDRCxTQUNBO1FBRkMsbUJBQWMsR0FBZCxjQUFjO1FBQ2YsWUFBTyxHQUFQLE9BQU87UUFDUCxjQUFTLEdBQVQsU0FBUztnQ0E5QlEsU0FBUztzQkFHSyxTQUFTLENBQUMsTUFBTTtzQ0FDTCxFQUFFOzBCQUNkLEVBQUU7aUNBQ0ssRUFBRTtpQ0FDRixFQUFFO3FCQUN4QixDQUFDOzBCQUNJLENBQUM7MkJBQ0EsQ0FBQzt1QkFDRyxHQUFHOzs7dUNBR0ssNENBQTRDO3lCQUNsRCxPQUFPO3FCQUNYLEVBQUU7MEJBQ0csTUFBTTt5QkFDUCxNQUFNO3dCQUNQLEVBQUU7NkJBQ0csU0FBUzs0QkFDVixRQUFRO3NCQUNiLEtBQUs7eUJBR25CLElBQUksQ0FBQyxHQUFHLEVBQUU7S0FPN0I7Ozs7O0lB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T25Jbml0LCBPbkNoYW5nZXMsIFRlbXBsYXRlUmVmLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBtZXJnZSwgT2JzZXJ2YWJsZSwgdGltZXIgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHN3aXRjaE1hcCwgZGVib3VuY2UsIGRpc3RpbmN0VW50aWxDaGFuZ2VkLCB0YXAsIHBhcnRpdGlvbiB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IE5neEh0dHBMb2FkZXJJbnRlcmNlcHRvciB9IGZyb20gJy4vbmd4LWxvYWRlci1pbnRlcmNlcHRvci5zZXJ2aWNlJztcbmltcG9ydCB7IE5neExvYWRlciB9IGZyb20gJy4vbmd4LWh0dHAtbG9hZGVyJztcbmltcG9ydCB7IE5neEh0dHBMb2FkZXJTZXJ2aWNlIH0gZnJvbSAnLi9uZ3gtaHR0cC1sb2FkZXIuc2VydmljZSc7XG5pbXBvcnQgeyBEb21TYW5pdGl6ZXIgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LWh0dHAtbG9hZGVyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25neC1odHRwLWxvYWRlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL25neC1odHRwLWxvYWRlci5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIE5neEh0dHBMb2FkZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XG5cbiAgcHVibGljIGN1c3RvbUVudW1Mb2FkZXIgPSBOZ3hMb2FkZXI7XG4gIEBJbnB1dCgpIHB1YmxpYyBjdXN0b21UZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcbiAgQElucHV0KCkgcHVibGljIGN1c3RvbUxvYWRlcjogVGVtcGxhdGVSZWY8YW55PjtcbiAgQElucHV0KCkgcHVibGljIGxvYWRlcjogc3RyaW5nIHwgbnVsbCA9IE5neExvYWRlci5SSVBQTEU7XG4gIEBJbnB1dCgpIHB1YmxpYyBmaWx0ZXJVcmxSZWdleFBhdHRlcm5zOiBSZWdFeHBbXSA9IFtdO1xuICBASW5wdXQoKSBwdWJsaWMgZmlsdGVyVXJsczogc3RyaW5nW10gPSBbXTtcbiAgQElucHV0KCkgcHVibGljIGZpbHRlckh0dHBIZWFkZXJzOiBzdHJpbmdbXSA9IFtdO1xuICBASW5wdXQoKSBwdWJsaWMgZmlsdGVySHR0cE1ldGhvZHM6IHN0cmluZ1tdID0gW107XG4gIEBJbnB1dCgpIHB1YmxpYyBkZWxheSA9IDA7XG4gIEBJbnB1dCgpIHB1YmxpYyBleHRyYURlbGF5ID0gMDtcbiAgQElucHV0KCkgcHVibGljIG1pbkR1cmF0aW9uID0gMDtcbiAgQElucHV0KCkgcHVibGljIG9wYWNpdHk6IG51bWJlciA9IDAuODtcbiAgLy8gQElucHV0KCkgcHVibGljIGJhY2tkcm9wQmFja2dyb3VuZENvbG9yID0gJ2xpbmVhci1ncmFkaWVudCg0NWRlZywgIzIyMjQyOCwgIzQ0NDg1NiknO1xuICAvLyBASW5wdXQoKSBwdWJsaWMgYmFja2Ryb3BCYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwZXJlbnQnO1xuICBASW5wdXQoKSBwdWJsaWMgYmFja2Ryb3BCYWNrZ3JvdW5kQ29sb3IgPSAnbGluZWFyLWdyYWRpZW50KDBkZWcsIGJsYWNrLCB0cmFuc3BhcmVudCk7JztcbiAgQElucHV0KCkgcHVibGljIGljb25Db2xvcjogc3RyaW5nID0gJ3doaXRlJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlOiBzdHJpbmcgPSAnJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlQ29sb3I6IHN0cmluZyA9ICcjZmZmJztcbiAgQElucHV0KCkgcHVibGljIHRpdGxlU2l6ZTogc3RyaW5nID0gJzNyZW0nO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGU6IHN0cmluZyA9ICcnO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGVDb2xvcjogc3RyaW5nID0gJyM2Yzc1N2QnO1xuICBASW5wdXQoKSBwdWJsaWMgc3ViVGl0bGVTaXplOiBzdHJpbmcgPSAnMS4ycmVtJztcbiAgQElucHV0KCkgcHVibGljIGN1c3RvbTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHB1YmxpYyBzaG93JCE6IE9ic2VydmFibGU8Ym9vbGVhbj47XG4gIHByaXZhdGUgc2hvd3VudGlsID0gRGF0ZS5ub3coKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlcXVlc3RTZXJ2aWNlOiBOZ3hIdHRwTG9hZGVySW50ZXJjZXB0b3IsXG4gICAgcHVibGljIHNlcnZpY2U6IE5neEh0dHBMb2FkZXJTZXJ2aWNlLFxuICAgIHB1YmxpYyBzYW5pdGl6ZXI6IERvbVNhbml0aXplclxuICApIHtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5maWx0ZXJVcmxSZWdleFBhdHRlcm5zLmxlbmd0aCA+IDAgfHwgdGhpcy5maWx0ZXJVcmxzLmxlbmd0aCA+IDBcbiAgICAgIHx8IHRoaXMuZmlsdGVySHR0cEhlYWRlcnMubGVuZ3RoID4gMCB8fCB0aGlzLmZpbHRlckh0dHBNZXRob2RzLmxlbmd0aCA+IDApIHRoaXMuaW5pdEFsbEZpbHRlcnMoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuaW5pdEFsbEZpbHRlcnMoKTtcbiAgfVxuXG4gIGluaXRBbGxGaWx0ZXJzKCkge1xuICAgIHRoaXMucmVxdWVzdFNlcnZpY2Uuc2V0VXJsUGF0dGVybnMgPSB0aGlzLmZpbHRlclVybFJlZ2V4UGF0dGVybnM7XG4gICAgdGhpcy5yZXF1ZXN0U2VydmljZS5zZXRGaWx0ZXJVcmxzID0gdGhpcy5maWx0ZXJVcmxzO1xuICAgIHRoaXMucmVxdWVzdFNlcnZpY2Uuc2V0RmlsdGVyTWV0aG9kcyA9IHRoaXMuZmlsdGVySHR0cE1ldGhvZHM7XG4gICAgdGhpcy5yZXF1ZXN0U2VydmljZS5zZXRGaWx0ZXJIZWFkZXJzID0gdGhpcy5maWx0ZXJIdHRwSGVhZGVycztcbiAgICB0aGlzLmluaXRTaG93T2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgaW5pdFNob3dPYnNlcnZhYmxlKCkge1xuICAgIGNvbnN0IFtzaG93LCBoaWRlXSA9IHBhcnRpdGlvbigoJGhpZGU6IGJvb2xlYW4pID0+ICRoaWRlKSh0aGlzLnJlcXVlc3RTZXJ2aWNlLnJlcVN0YXR1cyk7XG4gICAgdGhpcy5zaG93JCA9IG1lcmdlKFxuICAgICAgdGhpcy5yZXF1ZXN0U2VydmljZS5yZXFTdGF0dXMucGlwZShzd2l0Y2hNYXAoKCkgPT4gc2hvdy5waXBlKGRlYm91bmNlKCgpID0+IHRpbWVyKHRoaXMuZGVsYXkpKSkpKSxcbiAgICAgIHNob3cucGlwZShzd2l0Y2hNYXAoKCkgPT4gaGlkZS5waXBlKGRlYm91bmNlKCgpID0+IHRoaXMuc2hvd1VwdG8oKSkpKSksXG4gICAgICB0aGlzLnNlcnZpY2UuaXNTaG93TG9hZGVyXG4gICAgKS5waXBlKGRpc3RpbmN0VW50aWxDaGFuZ2VkKCksIHRhcCh4ID0+IHRoaXMudXBkYXRlSGlkZURlbGF5KHgpKSlcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlSGlkZURlbGF5KGJvb2w6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBpZiAoYm9vbCkgdGhpcy5zaG93dW50aWwgPSBEYXRlLm5vdygpICsgdGhpcy5taW5EdXJhdGlvbjtcbiAgfVxuXG4gIHByaXZhdGUgc2hvd1VwdG8oKTogT2JzZXJ2YWJsZTxudW1iZXI+IHtcbiAgICByZXR1cm4gdGltZXIoTWF0aC5tYXgodGhpcy5leHRyYURlbGF5LCB0aGlzLnNob3d1bnRpbCAtIERhdGUubm93KCkpKTtcbiAgfVxufVxuIl19